<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/strict.dtd"><html>	<head>		<title>HTTP UserAgent cleaner</title>		<meta name="description" content="Принудительный HPKP">		<!--#include file="links.inc"-->	</head>	<body><DIV align = center ><DIV id=maindiv>		<!--#include file="_begin.inc"-->			<H1>Дополнение для FireFox "HTTP UserAgent cleaner" - справка</H1>			<br><br>			<!--#include file="_support.inc"-->			<br>			<hr>			<br><br>			<!--a href="">Help in screenshots</a>			<br><br-->			<!--Справка (только на русском) -->			<br><br>				Дополнение даёт две оценки стойкости TLS. Это стойкость шифрования TLS и время действия HPKP.				<br><img src='i2/HPKP2.png'><br><br>				HPKP позволяет значительно повысить безопасность соединения с помощью Public Key Pinning (Certificat Pinning).<br>				Дело в том, что при утере удостоверяющим центром любого промежуточного сертификата, способного подписывать сертификаты любых серверов, весь интернет находится в опасности. Мы не можем узнать, нам отдают подлинный сертификат сервера или подложный сертификат, подписанный украденным (или выданным по запросу правительства некоторой страны) промежуточным сертификатом.<br><br>				Для предотвращения подмены сертификата и используется технология HPKP (Public Key Pinning for HTTP).<br>				Сервер, при первом использовании, объявляет, что есть доверенные сертификаты, и использование других не допускается. Поэтому при попытке перехвата соединения другим сертификатом, FireFox откажется соединяться с сервером, предотвратив утечку данных.<br><br>				При этом FireFox, вместо сайта, выдаст страницу с ошибкой загрузки соединения, где будет написано, что имеется нарушение HPKP или HSTS политики.<br><br>				Чтение оценки.<br>				Оценка TLS. 85% - великолепно, 70% - отличная оценка для сайта, 55% - очень хорошая; 40% - хорошая, 25% - удовлетворительная, 10% - допустимая.<br>				Оценка HPKP. 30% - допустимая, 45% - хорошая, 60% - отличная. Большинство сайтов не используют HPKP вообще (оценка 0).<br><br>				<br><img src='i2/HPKP1.png'><br><br>				На этой картинке мы видим оценку HPKP, состояющую из двух частей: времени жизни и сертификат для закрепления. Серверный сертификат получает оценку 100%, остальные сниженную оценку. Время жизни говорит о том, как долго настройка закрепления сертификата имеет силу (в днях). После истечения этого срока, HPKP перестаёт действовать до тех пор, пока вы снова не зайдёте на сайт и не получите обновлённые HPKP-данные. Если время жизни меньше 45-ти дней, оценка получает штраф в два раза.<br>				<br><br><br><br>				Так как большинство сайтов не используют HPKP, то дополнение предоставляет возможность использования принудительного HPKP с помощью фильтра CertsHPKP. Работа фильтра CertsHPKP - очень грубая технология, требующая повышенного внимания пользователя, используйте её, если хорошо понимаете, как работает HPKP, и вам нужна повышенная безопаность. Кроме этого, методика работы фильтра CertsHPKP противоречит некоторым особенностям архитектуры FireFox, из-за чего безопасность не совсем полная (с некоторой вероятностью возможно использование подложного сертификата, поэтому используйте фильтр Certs:Info или Certs:Weak совместно).<br><br>				Включите на вкладке "Сторонние" фильтр CertsHPKP. Это делается аналогично фильтру Certs (всё равно используйте его), однако, необходимо учитывать следующее. CertsHPKP вынуждает FireFox сохранять информацию о сертификатах хоста, а значит, если CertsHPKP включён в приватном режиме, то информация о посещённых в приватном режиме хостах будет сохранена. Если вы этого не хотите, используйте соответстующее условие для правила, устанавливающего фильтр CertsHPKP. Это условие "!PRIVATE" (с типом правила "obj").<br>				Кроме этого, FireFox работает нестабильно в приватном режиме с включённым фильтром CertsHPKP. Поэтому его отключение в приватном режиме предпочтительно (возможны искажения цепочки доверия сертификатов и выставляемой сайту оценки).<br><br><br>				CertsHPKP:+S - принудительно добавляет HPKP-правило для существующего сертификата сервера. CertsHPKP:+I - для промежуточного сертификата. CertsHPKP:+R - для корневого сертификата.<br><br>				Оригинальная технология HPKP позволяет серверу незаметно от пользователя изменять сертификаты на более новые. В отличие от оригинальных правил HPKP, фильтр CertsHPKP при смене сертификата не может обеспечить такой работы. FireFox будет блокировать соединение, указывая на ошибку в сертификате. В логе дополнения, а также в консоли будут соответствующие записи типа: "HUAC information: In the request was found the error of loading, this may be relevance to HPKP" (в консоли) или "In the request was found the error of loading, this may be relevance to HPKP or certs autodisable" (в логе).<br><br>				При появлении таких надписей, вы должны любым способом убедиться, что с сертификатами всё в порядке (например, посмотреть, что происходит с сайтом, из других браузеров). Если это так, для восстановления функционирования сайта, необходимо для страницы, на которой произошло срабатывание блокировки FireFox, установить фильтр CertsHPKP в режим CertsHPKP:X (с приоритетом выше, чем фильтр CertsHPKP:+S). Теперь фильтр CertsHPKP:X сбросит HPKP-информацию для тех хостов, которые были заблокированы при следующей попытке загрузки. Очистите лог (консоль), перезагрузите страницу и посмотрите, что в логе больше нет таких сообщений. Если есть, то перезагрузите страницу ещё раз. После этого, если всё сделано правильно, сообщения должны исчезнуть. Теперь можно отключить CertsHPKP:X.<br><br><br><br>				google.com и другие сайты Google часто меняют сертификаты и не используют HPKP. Поэтому, использовать CertsHPKP:+S для этих сервисов не получится: страницы будут часто блокироваться, а функциональность сайтов нарушаться. Используйте CertsHPKP:+I (промежуточные сертификаты Google меняет редко). Аналогично, когда вы используете фильтр Certs в режиме Certs:Weak, используйте и CertsHPKP:+I вместо CertsHPKP:+S.<br>				rd[:1]=blogspot.ru | rd[:1]=blogblog.com | rd[:1]=blogger.com | rd[:1]=blogspot.com | rd[:1]=google.com | rd[:1]=google.ru | rd[:1]=gstatic.com | rd[:1]=googleapis.com | rd[:1]=youtube.com | rd[:1]=ytimg.com | rd[:1]=googlevideo.com | rd[:1]=gmail.com | rd[:1]=googleusercontent.com				<br>				<br><br><br><br>				<!--#include file="_menu.inc"-->				<br><br><DIV></DIV><!--#include file="mcyandex.inc"--></BODY></html>